import{_ as k,c as w,b as C,d as o,H as W,r as h,a as z,o as U,P as B,T as D,a7 as S,D as x,U as V,V as E,e as p,f as M,L as R,z as $,X as q,M as F,q as I}from"./index-CyrTIAon.js";/* empty css                 */const A={name:"SIdentify",props:{identifyCode:{type:String,default:"1234"},fontSizeMin:{type:Number,default:25},fontSizeMax:{type:Number,default:30},backgroundColorMin:{type:Number,default:255},backgroundColorMax:{type:Number,default:255},colorMin:{type:Number,default:0},colorMax:{type:Number,default:160},lineColorMin:{type:Number,default:100},lineColorMax:{type:Number,default:255},dotColorMin:{type:Number,default:0},dotColorMax:{type:Number,default:255},contentWidth:{type:Number,default:112},contentHeight:{type:Number,default:31}},methods:{randomNum(t,s){return Math.floor(Math.random()*(s-t)+t)},randomColor(t,s){let n=this.randomNum(t,s),r=this.randomNum(t,s),d=this.randomNum(t,s);return"rgb("+n+","+r+","+d+")"},drawPic(){let s=document.getElementById("s-canvas").getContext("2d");s.textBaseline="bottom",s.fillStyle=this.randomColor(this.backgroundColorMin,this.backgroundColorMax),s.fillRect(0,0,this.contentWidth,this.contentHeight);for(let n=0;n<this.identifyCode.length;n++)this.drawText(s,this.identifyCode[n],n);this.drawLine(s),this.drawDot(s)},drawText(t,s,n){t.fillStyle=this.randomColor(this.colorMin,this.colorMax),t.font=this.randomNum(this.fontSizeMin,this.fontSizeMax)+"px SimHei";let r=(n+1)*(this.contentWidth/(this.identifyCode.length+1)),d=this.randomNum(this.fontSizeMax,this.contentHeight-5);var i=this.randomNum(-45,45);t.translate(r,d),t.rotate(i*Math.PI/180),t.fillText(s,0,0),t.rotate(-i*Math.PI/180),t.translate(-r,-d)},drawLine(t){for(let s=0;s<5;s++)t.strokeStyle=this.randomColor(this.lineColorMin,this.lineColorMax),t.beginPath(),t.moveTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),t.lineTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),t.stroke()},drawDot(t){for(let s=0;s<80;s++)t.fillStyle=this.randomColor(0,255),t.beginPath(),t.arc(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight),1,0,2*Math.PI),t.fill()}},watch:{identifyCode(){this.drawPic()}},mounted(){this.drawPic()}},G={class:"s-canvas"},X=["width","height"];function j(t,s,n,r,d,i){return C(),w("div",G,[o("canvas",{id:"s-canvas",width:n.contentWidth,height:n.contentHeight},null,8,X)])}const J=k(A,[["render",j],["__scopeId","data-v-fc4647db"]]),K={class:"login-wrapper"},O={class:"login-container"},Q={class:"input-group"},Y={class:"input-group"},Z={key:0,class:"error-message"},tt={class:"form-middle"},et={style:{display:"flex"}},ot=["disabled"],st={class:"form-footer"},nt={__name:"Login",setup(t){const s=q(),n=W(),{handleLogin:r,isLogin:d}=n,i=h("1"),f=h(),c=h(""),a=z({role:i.value,username:"",password:""}),u=h(""),v=h(!1),g=()=>{a.username&&a.password?(v.value=!0,u.value=""):v.value=!1},P=async()=>{if(c.value!==f.value){b("验证码错误");return}const m=/(~|\{|\}|"|'|<|>|\?)/g;if(m.test(a.username)||m.test(a.password)){b("警告:输入内容包含非法字符");return}try{localStorage.setItem("role",i.value),await r({username:a.username,password:a.password,role:i.value}),s.push("/")}catch{b("登录失败，请稍后重试")}};function y(){a.username="",a.password=""}const b=m=>{u.value=m,setTimeout(()=>{u.value=""},3e3)},_=()=>Math.floor(1e3+Math.random()*9e3).toString(),H=()=>{f.value=_()};return U(()=>{y(),g(),f.value=_()}),B(()=>{y()}),(m,e)=>{const N=F,T=R,L=$;return C(),w("div",K,[o("div",O,[e[13]||(e[13]=o("div",{class:"form-header"},[o("h2",null,"用户登录"),o("p",null,"欢迎回来，请登录您的账号")],-1)),o("form",{onSubmit:D(P,["prevent"]),class:"floating-form"},[o("div",Q,[x(o("input",{id:"username","onUpdate:modelValue":e[0]||(e[0]=l=>a.username=l),type:"text",autocomplete:"off",onInput:g,required:"",placeholder:"           可以使用用户名/手机号/邮箱/进行登录"},null,544),[[V,a.username,void 0,{trim:!0}]]),e[4]||(e[4]=o("label",{for:"username"},"用户名",-1)),e[5]||(e[5]=o("span",{class:"highlight"},null,-1))]),o("div",Y,[x(o("input",{id:"password","onUpdate:modelValue":e[1]||(e[1]=l=>a.password=l),type:"password",autocomplete:"off",onInput:g,required:""},null,544),[[V,a.password,void 0,{trim:!0}]]),e[6]||(e[6]=o("label",{for:"password"},"密码",-1)),e[7]||(e[7]=o("span",{class:"highlight"},null,-1))]),u.value?(C(),w("div",Z,E(u.value),1)):S("",!0),o("div",tt,[p(T,{modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=l=>i.value=l)},{default:M(()=>[p(N,{value:"0"},{default:M(()=>e[8]||(e[8]=[I("管理员")])),_:1}),p(N,{value:"1"},{default:M(()=>e[9]||(e[9]=[I("普通用户")])),_:1})]),_:1},8,["modelValue"]),o("div",et,[p(L,{modelValue:c.value,"onUpdate:modelValue":e[3]||(e[3]=l=>c.value=l),style:{height:"35px",width:"120px"},placeholder:"请输入验证码"},null,8,["modelValue"]),p(J,{identifyCode:f.value,onClick:H},null,8,["identifyCode"])])]),o("button",{type:"submit",class:"submit-btn",disabled:!v.value},e[10]||(e[10]=[o("span",null,"登录",-1),o("i",{class:"arrow-icon"},null,-1)]),8,ot),o("div",st,[S("",!0),o("div",{class:"reset",onClick:y},"重置"),e[12]||(e[12]=o("div",{class:"reg"},[o("span",null,"还没有账号？"),o("a",{href:"/register"},"立即注册")],-1))])],32)])])}}},rt=k(nt,[["__scopeId","data-v-6170343d"]]);export{rt as default};
